<main class="c-everyQuestions">
  <mat-toolbar color="accent" class="c-everyQuestions__main">
    <ul class="c-everyQuestions__list">
      <li class="c-everyQuestions__item">
        <button
          type="button"
          mat-button
          mat-raised-button
          [matMenuTriggerFor]="filters"
        >
          <mat-icon>filter_alt</mat-icon>
        </button>
        <mat-menu #filters="matMenu">
          <form
            [formGroup]="filterQuestionsForm"
            class="c-everyQuestions__form"
          >
            <mat-icon>question_answer</mat-icon>
            <mat-label
              class="c-everyQuestions__label"
              *ngFor="let status of statusFormArray.controls; let i = index"
              formArrayName="status"
            >
              <mat-checkbox
                [formControlName]="i"
                [checked]="status.value"
                [id]="questionsStatusData[i].id"
                [name]="questionsStatusData[i].item"
                (change)="onFilterByStatusQuestions($event)"
                >{{ questionsStatusData[i].item }}</mat-checkbox
              >
            </mat-label>
            <mat-divider></mat-divider>
            <mat-icon>tag</mat-icon>
            <mat-label
              class="c-everyQuestions__label"
              *ngFor="let tag of tagsFormArray.controls; let i = index"
              formArrayName="tags"
            >
              <mat-checkbox
                [formControlName]="i"
                [name]="tagsData[i].item"
                (change)="onFilterByTags($event)"
                >{{ tagsData[i].item }}</mat-checkbox
              >
            </mat-label>
            <mat-divider></mat-divider>
            <mat-icon>timeline</mat-icon>
            <mat-label
                class="c-everyQuestions__label"
                *ngFor="let time of timeFormArray.controls; let i = index"
                formArrayName="time"
            >
              <mat-checkbox
                [formControlName]="i"
                [checked]="time.value"
                [id]="questionsTimeData[i].id"
                [name]="questionsTimeData[i].value"
                (change)="onFilterPerPeriodOfTime($event)"
                >{{questionsTimeData[i].item}}</mat-checkbox
              >
            </mat-label>
          </form>
        </mat-menu>
      </li>
      <li class="c-everyQuestions__item">
        <button
          type="button"
          mat-button
          mat-raised-button
          (click)="onSortQuestions()"
        >
          <mat-icon>sort</mat-icon>
        </button>
      </li>
      <li class="c-everyQuestions__item">
        <button
          type="button"
          mat-button
          mat-raised-button
          [matMenuTriggerFor]="settings"
        >
          <mat-icon>settings</mat-icon>
        </button>
        <mat-menu #settings="matMenu">
          <form class="c-everyQuestions__form">
            <mat-icon>view_module</mat-icon>
            <mat-radio-group
              class="c-everyQuestions__label"
              name="display"
              *ngFor="let display of questionsDisplayData">
              <mat-radio-button
                class="mat-radio-button"
                name="display"
                [checked]="display.checked"
                [value]="display.name"
                (change)="onDisplayQuestions(display.name)"
                >{{display.name}} display</mat-radio-button
              >
            </mat-radio-group>
          </form>
          <mat-divider></mat-divider>
          <form class="c-everyQuestions__form">
            <mat-icon>palette</mat-icon>
            <mat-radio-group
              class="c-everyQuestions__label"
              name="theme"
              *ngFor="let theme of themeData"
            >
              <mat-radio-button
                class="mat-radio-button"
                name="theme"
                [checked]="theme.checked"
                [value]="theme.name"
                (change)="onChangeTheme(theme.name)"
              >{{ theme.name }} theme
              </mat-radio-button
              >
            </mat-radio-group>
          </form>
        </mat-menu>
      </li>
    </ul>
  </mat-toolbar>

  <div
    class="c-everyQuestions__section c-everyQuestions__section--tiled"
    *ngIf="isLineDisplay === false"
  >
    <mat-card
      class="c-everyQuestions__card"
      *ngFor="
        let question of questionsArray
          | filterByStatusQuestions: statusQuestions
          | filterByTags: electedTags
          | filterPerPeriodOfTime: timeQuestions
          | filterBySort: isSortQuestions
      "
    >
      <mat-card-title
        class="c-everyQuestions__title"
        (click)="onOpenScreenQuestionById(question.key)"
        >{{ question.title }}</mat-card-title
      >
      <hr />
      <mat-card-content class="c-everyQuestions__content">
        <p class="c-everyQuestions__date">
          {{ question.date | date: "MMM d, y, h:mm:ss a" }}
        </p>
        <a class="c-everyQuestions__tag" *ngFor="let tag of question['tags']"
          >{{ tag }}
        </a>
      </mat-card-content>
      <hr />
      <div class="c-everyQuestions__buttons">
        <small
          *ngIf="
            question.isApproval === false &&
            (question.author === author || isAdmin === true)
          "
          class="c-everyQuestions__moderation"
          >Moderation</small
        >
        <button
          *ngIf="question.isApproval === false && isAdmin === true"
          class="c-everyQuestions__button"
          type="submit"
          mat-raised-button
          color="primary"
          (click)="onApproveQuestion(question.key)"
        >
          <mat-icon>approval</mat-icon>
        </button>
        <button
          *ngIf="question.author === author || isAdmin === true"
          class="c-everyQuestions__button"
          mat-raised-button
          color="warn"
          (click)="onRemoveQuestionById(question.key)"
        >
          <mat-icon>delete_forever</mat-icon>
        </button>
      </div>
    </mat-card>
  </div>

  <div
    class="c-everyQuestions__section c-everyQuestions__section--line"
    *ngIf="isLineDisplay === true"
  >
    <mat-card
      class="c-everyQuestions__card"
      *ngFor="
        let question of questionsArray
          | filterByStatusQuestions: statusQuestions
          | filterByTags: electedTags
          | filterPerPeriodOfTime: timeQuestions
          | filterBySort: isSortQuestions
      "
    >
      <mat-card-title
        class="c-everyQuestions__title"
        (click)="onOpenScreenQuestionById(question.key)"
        >{{ question.title }}</mat-card-title
      >
      <hr />
      <mat-card-content class="c-everyQuestions__content">
        <p class="c-everyQuestions__date">
          {{ question.date | date: "MMM d, y, h:mm:ss a" }}
        </p>
        <a class="c-everyQuestions__tag" *ngFor="let tag of question['tags']"
          >{{ tag }}
        </a>
      </mat-card-content>
      <hr />
      <div class="c-everyQuestions__buttons">
        <small
          *ngIf="
            question.isApproval === false &&
            (question.author === author || isAdmin === true)
          "
          class="c-everyQuestions__moderation"
          >Moderation</small
        >
        <button
          *ngIf="question.isApproval === false && isAdmin === true"
          class="c-everyQuestions__button"
          type="submit"
          mat-raised-button
          color="primary"
        >
          <mat-icon>approval</mat-icon>
        </button>
        <button
          *ngIf="question.author === author || isAdmin === true"
          class="c-everyQuestions__button"
          mat-raised-button
          color="warn"
          (click)="onRemoveQuestionById(question.key)"
        >
          <mat-icon>delete_forever</mat-icon>
        </button>
      </div>
    </mat-card>
  </div>
</main>
